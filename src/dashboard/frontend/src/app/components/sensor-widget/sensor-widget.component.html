<!-- pages/sensor-widget/sensor-widget.component.html -->
<div class="sensor-widget-container">

  <!-- Header -->
  <header class="widget-header">
    <a routerLink="/dashboard" class="back-btn">
      ← Back to Dashboard
    </a>

    @if (sensorService.currentConfig(); as config) {
      <div class="sensor-title">
        <h1>{{ config.name }}</h1>
        <span class="sensor-meta">
          {{ config.type | titlecase }}
          @if (config.location) {
            • {{ config.location }}
          }
        </span>
      </div>
    } @else {
      <div class="sensor-title">
        <h1>Loading...</h1>
      </div>
    }

    <!-- Connection Status -->
    <div class="connection-status" [class.connected]="sensorService.isConnected()">
      <span class="status-dot"></span>
      {{ sensorService.isConnected() ? 'Live' : 'Offline' }}
    </div>
  </header>

  <main>
    <!-- Current Value Card -->
    <div class="current-value-card">
      <span class="label">Current Reading</span>
      <div class="value-row">
        <span class="value">{{ sensorService.currentValue() | number:'1.2-2' }}</span>
        <span class="unit">{{ sensorService.currentConfig()?.unit }}</span>
      </div>
      @if (sensorService.lastUpdated(); as time) {
        <span class="timestamp">Last updated: {{ time | date:'mediumTime' }}</span>
      }
    </div>

    <!-- Chart Section -->
    <div class="chart-section">
      <h2>Real-Time Data</h2>
      <div class="chart-wrapper">
        <canvas baseChart
          [data]="chartData"
          [options]="chartOptions"
          type="line">
        </canvas>
      </div>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
      <div class="stat-card">
        <span class="stat-label">Minimum</span>
        <span class="stat-value">{{ sensorService.stats().min | number:'1.2-2' }}</span>
      </div>
      <div class="stat-card">
        <span class="stat-label">Maximum</span>
        <span class="stat-value">{{ sensorService.stats().max | number:'1.2-2' }}</span>
      </div>
      <div class="stat-card">
        <span class="stat-label">Average</span>
        <span class="stat-value">{{ sensorService.stats().avg | number:'1.2-2' }}</span>
      </div>
      <div class="stat-card">
        <span class="stat-label">Data Points</span>
        <span class="stat-value">{{ sensorService.stats().count }}</span>
      </div>
    </div>
  </main>

</div>