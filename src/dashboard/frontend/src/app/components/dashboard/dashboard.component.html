<!-- components/dashboard/dashboard.component.html -->
<div class="dashboard-container">
  <!-- Header -->
  <header>
    <div class="header-left">
      <h1>Sensor Dashboard</h1>
      @if (userTenant()) {
        <span class="tenant-badge">{{ tenantName() }}</span>
      }
    </div>
    <div class="header-right">
      <span class="user-info">{{ userName() }}</span>
      <button (click)="logout()" class="logout-btn">Logout</button>
    </div>
  </header>

  <main>
    @if (currentUser(); as user) {
      <!-- Account Info Section -->
      <section class="section">
        <h2>Account Info</h2>
        <div class="info-card">
          <div class="info-row">
            <span class="info-label">Username</span>
            <span class="info-value">{{ user.username }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Organization</span>
            <span class="info-value">{{ user.tenant.name }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Tenant ID</span>
            <span class="info-value">{{ user.tenant.natsId }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Member Since</span>
            <span class="info-value">{{ user.createdAt | date:'mediumDate' }}</span>
          </div>
        </div>
      </section>

      <!-- Sensors Section -->
      <section class="section">
        <div class="section-header">
          <h2>Sensors</h2>
          <button (click)="loadSensors()" class="refresh-btn" [disabled]="sensorsLoading()">
            @if (sensorsLoading()) {
              <span class="spinner-small"></span>
            }
            Refresh
          </button>
        </div>

        @if (sensorsLoading()) {
          <div class="loading-container">
            <span class="spinner"></span>
            <p>Loading sensors...</p>
          </div>
        } @else if (sensorsError()) {
          <div class="error-container">
            <p class="error-message">{{ sensorsError() }}</p>
            <button (click)="loadSensors()" class="retry-btn">Try Again</button>
          </div>
        } @else if (sensors().length === 0) {
          <div class="empty-container">
            <p>No sensors found for this tenant.</p>
          </div>
        } @else {
          <div class="table-container">
            <table class="sensors-table">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Type</th>
                  <th>Unit</th>
                </tr>
              </thead>
              <tbody>
                @for (sensor of sensors(); track sensor.id) {
                  <tr>
                    <td class="sensor-name">{{ sensor.id }}</td>
                    <td>{{ sensor.sensorType }}</td>
                    <td>{{ sensor.unit }}</td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        }
      </section>

    } @else {
      <div class="loading-container full-page">
        <span class="spinner-large"></span>
        <p>Loading dashboard...</p>
      </div>
    }
  </main>
</div>